# LLM Proxy Server

ä¸€ä¸ªç”¨äºè°ƒè¯•å’Œç›‘æ§ LLM API è°ƒç”¨çš„ä»£ç†æœåŠ¡å™¨ã€‚å¯ä»¥æ‹¦æˆªå¹¶æ‰“å°æ‰€æœ‰è¯·æ±‚å’Œå“åº”å†…å®¹ï¼Œæ”¯æŒæµå¼å“åº”ï¼ˆSSEï¼‰ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… æ‹¦æˆªå¹¶æ‰“å°æ‰€æœ‰ HTTP è¯·æ±‚å†…å®¹
- âœ… æ‹¦æˆªå¹¶æ‰“å°æ‰€æœ‰å“åº”å†…å®¹ï¼ˆåŒ…æ‹¬æµå¼å“åº”ï¼‰
- âœ… è‡ªåŠ¨è¯†åˆ« SSE æµå¼å“åº”å¹¶å®æ—¶æ‰“å°
- âœ… å½©è‰²æ ¼å¼åŒ–è¾“å‡ºï¼Œä¾¿äºé˜…è¯»
- âœ… è‡ªåŠ¨éšè—æ•æ„Ÿä¿¡æ¯ï¼ˆAPI Keyï¼‰
- âœ… æ”¯æŒ OpenAIã€Claudeã€Azure OpenAI ç­‰æ‰€æœ‰ LLM API

## å®‰è£…

```bash
npm install
```

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ä½¿ç”¨

```bash
# å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆé»˜è®¤ä»£ç†åˆ° OpenAI APIï¼‰
npm start

# æˆ–è€…ä½¿ç”¨å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡è½½ï¼‰
npm run dev
```

### ç¯å¢ƒå˜é‡é…ç½®

| å˜é‡ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `PORT` | `8080` | ä»£ç†æœåŠ¡å™¨ç›‘å¬ç«¯å£ |
| `TARGET_URL` | `https://api.openai.com` | ç›®æ ‡ API åœ°å€ |
| `LOG_HEADERS` | `true` | æ˜¯å¦æ‰“å°è¯·æ±‚å¤´ |
| `PRETTY_JSON` | `true` | æ˜¯å¦ç¾åŒ– JSON è¾“å‡º |

### ç¤ºä¾‹

#### ä»£ç† OpenAI API

```bash
# å¯åŠ¨ä»£ç†
npm start

# ä½¿ç”¨ä»£ç†å‘é€è¯·æ±‚
curl http://localhost:8080/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-your-api-key" \
  -d '{
    "model": "gpt-4",
    "messages": [{"role": "user", "content": "Hello!"}]
  }'
```

#### ä»£ç† Claude API

```bash
# å¯åŠ¨ä»£ç†ï¼ˆæŒ‡å®šç›®æ ‡ä¸º Anthropic APIï¼‰
TARGET_URL=https://api.anthropic.com npm start

# ä½¿ç”¨ä»£ç†å‘é€è¯·æ±‚
curl http://localhost:8080/v1/messages \
  -H "Content-Type: application/json" \
  -H "x-api-key: your-api-key" \
  -H "anthropic-version: 2023-06-01" \
  -d '{
    "model": "claude-3-opus-20240229",
    "max_tokens": 1024,
    "messages": [{"role": "user", "content": "Hello!"}]
  }'
```

#### ä»£ç† Azure OpenAI

```bash
TARGET_URL=https://your-resource.openai.azure.com npm start
```

## åœ¨ä»£ç ä¸­ä½¿ç”¨

åªéœ€å°† API çš„ base URL æ›¿æ¢ä¸ºä»£ç†åœ°å€ï¼š

### Python (OpenAI SDK)

```python
from openai import OpenAI

client = OpenAI(
    api_key="your-api-key",
    base_url="http://localhost:8080/v1"  # æŒ‡å‘ä»£ç†
)

response = client.chat.completions.create(
    model="gpt-4",
    messages=[{"role": "user", "content": "Hello!"}]
)
```

### Node.js (OpenAI SDK)

```javascript
import OpenAI from 'openai';

const client = new OpenAI({
  apiKey: 'your-api-key',
  baseURL: 'http://localhost:8080/v1'  // æŒ‡å‘ä»£ç†
});

const response = await client.chat.completions.create({
  model: 'gpt-4',
  messages: [{ role: 'user', content: 'Hello!' }]
});
```

## è¾“å‡ºç¤ºä¾‹

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          ğŸ” LLM Proxy Server Started                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Listening on:     http://localhost:8080                        â•‘
â•‘ Proxying to:      https://api.openai.com                       â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Usage: Set your API base URL to http://localhost:8080          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

 â–¶ REQUEST [1]  2024-01-15T10:30:00.000Z
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
POST /v1/chat/completions
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Headers:
{
  "content-type": "application/json",
  "authorization": "Bearer sk-xxxxxxxx..."
}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Body:
{
  "model": "gpt-4",
  "messages": [
    {
      "role": "user",
      "content": "Hello!"
    }
  ]
}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

 â—€ RESPONSE [1]  2024-01-15T10:30:01.000Z
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Status: 200
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Body:
{
  "id": "chatcmpl-xxx",
  "choices": [
    {
      "message": {
        "role": "assistant",
        "content": "Hello! How can I help you today?"
      }
    }
  ]
}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## License

MIT

